#!/bin/bash

##--------------------------
# takes target FROM and TO positions, query cultivar's SNPs in vcf format as input, and generate a list of
# cultivars from 3kRGP as close-relatives of the query cultivar based on the best matched SNP profile (haplovars) as output.

source ./0SOURCE

# softlink vcf files
cd ${rice3k_DIR}
mkdir -p analysis/ThaRegGA
cd analysis/ThaRegGA
# ln -s ${SNP_DIR}/*snp.vcf .
ln -s ${SNP_DIR}/gatk_ZHENGSHAN97_env_snp.vcf .

# cultivar identification
\rm ${SAMPLENAME}_Haplovar.results
for file in *.vcf ;
        do python2 ${rice3k_DIR}/scripts/identify.py ${PLINKFNAME} $file >> ${SAMPLENAME}_Haplovar.results;
done

